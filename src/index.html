<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil | Tô Lendo</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <img src="https://github.com/user-attachments/assets/8e859c12-7277-432a-ae1f-3f4af7803a4d" alt="Tô Lendo">
            </div>
            <nav class="nav">
                <a href="#" class="nav-link active"><i class="fas fa-home"></i> Home</a>
                <a href="#" class="nav-link"><i class="fas fa-user"></i> Meu Perfil</a>
                <button id="darkModeToggle" class="dark-mode-toggle" title="Alternar modo escuro">
                    <i class="fas fa-moon"></i>
                </button>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Left Sidebar - User Profile -->
        <aside class="sidebar">
            <div class="profile-card">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Ccircle cx='60' cy='60' r='60' fill='%23e9ecef'/%3E%3Ccircle cx='60' cy='45' r='20' fill='%236c757d'/%3E%3Cellipse cx='60' cy='95' rx='30' ry='20' fill='%236c757d'/%3E%3C/svg%3E" alt="Igor da Silva">
                        <button class="edit-profile-btn">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <h2 class="profile-name">IGOR DA SILVA</h2>
                    <p class="profile-username">@IGORDASILVA</p>
                </div>

                <div class="genre-tags">
                    <span class="genre-tag active">Ficção</span>
                    <span class="genre-tag">Romance</span>
                    <span class="genre-tag">Terror</span>
                    <span class="genre-tag">Fantasia</span>
                </div>

                <div class="reading-stats">
                    <div class="stat-item">
                        <span class="stat-number">0</span>
                        <span class="stat-label">Lidos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">0</span>
                        <span class="stat-label">Favoritos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">0</span>
                        <span class="stat-label">Lendo</span>
                    </div>
                </div>

                <div class="currently-reading">
                    <h3>Lendo Agora</h3>
                    <p class="no-book">Nenhum livro sendo lido no momento</p>
                </div>

                <div class="profile-actions">
                    <button class="btn-secondary">
                        <i class="fas fa-edit"></i> Editar Perfil
                    </button>
                    <button class="btn-primary">
                        <i class="fas fa-plus"></i> Adicionar Livro
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="content">
            <!-- About Section -->
            <section class="about-section">
                <div class="section-header">
                    <h2><i class="fas fa-info-circle"></i> Sobre Mim</h2>
                </div>
                <div class="about-info">
                    <div class="info-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span><strong>Localização:</strong> BELO HORIZONTE, MG</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-birthday-cake"></i>
                        <span><strong>Idade:</strong> 29 anos</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-briefcase"></i>
                        <span><strong>Profissão:</strong> ANALISTA</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-target"></i>
                        <span><strong>Meta de Leitura:</strong> 25 livros por ano</span>
                    </div>
                </div>
                <div class="bio">
                    <p><em>JOVEM E CASEIRO</em></p>
                </div>
            </section>

            <!-- Navigation Tabs -->
            <div class="content-tabs">
                <button class="tab-btn active" data-tab="biblioteca">
                    <i class="fas fa-book"></i> Minha Biblioteca
                </button>
                <button class="tab-btn" data-tab="resenhas">
                    <i class="fas fa-pen-fancy"></i> Resenhas
                </button>
            </div>

            <!-- Tab Content Sections -->
            <div class="tab-content">
                <!-- Reviews Tab Content -->
                <div class="tab-panel" id="tab-resenhas" style="display: none;">
                    <section class="reviews-section">
                        <div class="section-header">
                            <h3><i class="fas fa-pen-fancy"></i> Minhas Resenhas</h3>
                            <div class="reviews-stats">
                                <span class="stat-badge">
                                    <i class="fas fa-star"></i>
                                    <span id="totalReviews">0</span> resenhas
                                </span>
                            </div>
                        </div>
                        <div class="reviews-container" id="reviewsContainer">
                            <div class="empty-state">
                                <i class="fas fa-pen-fancy"></i>
                                <p>Nenhuma resenha escrita ainda.</p>
                                <p class="empty-subtitle">Adicione livros com resenhas para vê-las aqui!</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Library Tab Content (Default) -->
                <div class="tab-panel" id="tab-biblioteca">
                    <!-- My Favorites Section -->
                    <section class="book-section" id="favorites">
                        <div class="section-header">
                            <h3><i class="fas fa-heart"></i> Meus Favoritos</h3>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-heart"></i>
                            <p>Nenhum livro favorito ainda.</p>
                        </div>
                    </section>

                    <!-- Currently Reading Section -->
                    <section class="book-section" id="currently-reading">
                        <div class="section-header">
                            <h3><i class="fas fa-book-open"></i> Lendo Atualmente</h3>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-book-open"></i>
                            <p>Nenhum livro nesta seção ainda.</p>
                        </div>
                    </section>

                    <!-- Want to Read Section -->
                    <section class="book-section" id="want-to-read">
                        <div class="section-header">
                            <h3><i class="fas fa-bookmark"></i> Quero Ler</h3>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-bookmark"></i>
                            <p>Nenhum livro nesta seção ainda.</p>
                        </div>
                    </section>

                    <!-- Finished Books Section -->
                    <section class="book-section" id="finished-books">
                        <div class="section-header">
                            <h3><i class="fas fa-check-circle"></i> Livros Finalizados</h3>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-check-circle"></i>
                            <p>Nenhum livro nesta seção ainda.</p>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <!-- Profile Edit Modal -->
    <div id="editProfileModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Editar Perfil</h2>
                <button class="modal-close" id="closeEditModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editProfileForm">
                    <div class="form-group">
                        <label for="fullName">Nome Completo</label>
                        <input type="text" id="fullName" name="fullName" placeholder="Digite seu nome completo" value="Igor da Silva">
                    </div>

                    <div class="form-group">
                        <label for="username">Nome de Usuário</label>
                        <input type="text" id="username" name="username" placeholder="@seu_usuario" value="@IGORDASILVA">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="age">Idade</label>
                            <select id="age" name="age">
                                <option value="">Selecione</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29" selected>29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                                <option value="32">32</option>
                                <option value="33">33</option>
                                <option value="34">34</option>
                                <option value="35">35</option>
                                <option value="36">36</option>
                                <option value="37">37</option>
                                <option value="38">38</option>
                                <option value="39">39</option>
                                <option value="40">40</option>
                                <option value="41">41</option>
                                <option value="42">42</option>
                                <option value="43">43</option>
                                <option value="44">44</option>
                                <option value="45">45</option>
                                <option value="46">46</option>
                                <option value="47">47</option>
                                <option value="48">48</option>
                                <option value="49">49</option>
                                <option value="50">50+</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="location">Localização</label>
                            <input type="text" id="location" name="location" placeholder="São Paulo, SP" value="Belo Horizonte, MG">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="profession">Profissão</label>
                        <input type="text" id="profession" name="profession" placeholder="Desenvolvedor, Professor, Engenheiro..." value="Analista">
                    </div>

                    <div class="form-group">
                        <label for="bio">Sobre Mim</label>
                        <textarea id="bio" name="bio" placeholder="Conte um pouco sobre você, seus gostos literários e o que mais gosta de ler..." rows="4">JOVEM E CASEIRO</textarea>
                    </div>

                    <div class="form-group">
                        <label for="readingGoal">Meta de Livros por Ano</label>
                        <select id="readingGoal" name="readingGoal">
                            <option value="">Selecione</option>
                            <option value="5">5 livros</option>
                            <option value="10">10 livros</option>
                            <option value="12">12 livros</option>
                            <option value="15">15 livros</option>
                            <option value="20">20 livros</option>
                            <option value="25" selected>25 livros</option>
                            <option value="30">30 livros</option>
                            <option value="35">35 livros</option>
                            <option value="40">40 livros</option>
                            <option value="50">50 livros</option>
                            <option value="100">100+ livros</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelEdit">Cancelar</button>
                <button type="submit" class="btn-primary" id="saveProfile">Salvar Perfil</button>
            </div>
        </div>
    </div>

    <!-- Add Book Modal -->
    <div id="addBookModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Adicionar Livro</h2>
                <button class="modal-close" id="closeAddBookModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addBookForm">
                    <div class="form-group">
                        <label for="bookTitle">Título</label>
                        <input type="text" id="bookTitle" name="bookTitle" placeholder="Digite o título do livro" required>
                    </div>

                    <div class="form-group">
                        <label for="bookAuthor">Autor</label>
                        <input type="text" id="bookAuthor" name="bookAuthor" placeholder="Digite o nome do autor" required>
                    </div>

                    <div class="form-group">
                        <label for="bookGenre">Gênero</label>
                        <select id="bookGenre" name="bookGenre" required>
                            <option value="">Selecione um gênero</option>
                            <option value="Ficção">Ficção</option>
                            <option value="Romance">Romance</option>
                            <option value="Terror">Terror</option>
                            <option value="Fantasia">Fantasia</option>
                            <option value="Mistério">Mistério</option>
                            <option value="Biografia">Biografia</option>
                            <option value="História">História</option>
                            <option value="Autoajuda">Autoajuda</option>
                            <option value="Ciência">Ciência</option>
                            <option value="Tecnologia">Tecnologia</option>
                            <option value="Filosofia">Filosofia</option>
                            <option value="Poesia">Poesia</option>
                            <option value="Drama">Drama</option>
                            <option value="Aventura">Aventura</option>
                            <option value="Suspense">Suspense</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bookStatus">Status</label>
                        <select id="bookStatus" name="bookStatus" required>
                            <option value="">Selecione o status</option>
                            <option value="Quero ler">Quero ler</option>
                            <option value="Lendo">Lendo</option>
                            <option value="Finalizado">Finalizado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bookPages">Total de páginas</label>
                        <input type="number" id="bookPages" name="bookPages" placeholder="0" min="1">
                    </div>

                    <div class="form-group">
                        <label for="bookCover">URL da Capa</label>
                        <input type="url" id="bookCover" name="bookCover" placeholder="https://exemplo.com/capa.jpg">
                    </div>

                    <div class="form-group">
                        <label for="bookReview">Resenha (opcional)</label>
                        <textarea id="bookReview" name="bookReview" placeholder="Escreva sua opinião sobre o livro..." rows="4"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="bookFavorite" name="bookFavorite">
                            <span class="checkmark"></span>
                            Marcar como favorito
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelAddBook">Cancelar</button>
                <button type="submit" class="btn-primary" id="saveBook">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Genre Selection Modal -->
    <div id="genreSelectionModal" class="modal-overlay">
        <div class="modal genre-modal">
            <div class="modal-header">
                <h2>Selecionar Gêneros Favoritos</h2>
                <button class="modal-close" id="closeGenreModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p class="genre-subtitle">Selecione os gêneros literários que você mais gosta:</p>
                <div class="genre-grid">
                    <div class="genre-option" data-genre="Ficção">
                        <div class="genre-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <span class="genre-name">Ficção</span>
                    </div>
                    <div class="genre-option" data-genre="Romance">
                        <div class="genre-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <span class="genre-name">Romance</span>
                    </div>
                    <div class="genre-option" data-genre="Fantasia">
                        <div class="genre-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <span class="genre-name">Fantasia</span>
                    </div>
                    <div class="genre-option" data-genre="Mistério">
                        <div class="genre-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <span class="genre-name">Mistério</span>
                    </div>
                    <div class="genre-option" data-genre="Biografia">
                        <div class="genre-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <span class="genre-name">Biografia</span>
                    </div>
                    <div class="genre-option" data-genre="História">
                        <div class="genre-icon">
                            <i class="fas fa-landmark"></i>
                        </div>
                        <span class="genre-name">História</span>
                    </div>
                    <div class="genre-option" data-genre="Ciência">
                        <div class="genre-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <span class="genre-name">Ciência</span>
                    </div>
                    <div class="genre-option" data-genre="Autoajuda">
                        <div class="genre-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <span class="genre-name">Autoajuda</span>
                    </div>
                    <div class="genre-option" data-genre="Poesia">
                        <div class="genre-icon">
                            <i class="fas fa-feather-alt"></i>
                        </div>
                        <span class="genre-name">Poesia</span>
                    </div>
                    <div class="genre-option" data-genre="Aventura">
                        <div class="genre-icon">
                            <i class="fas fa-compass"></i>
                        </div>
                        <span class="genre-name">Aventura</span>
                    </div>
                    <div class="genre-option" data-genre="Terror">
                        <div class="genre-icon">
                            <i class="fas fa-ghost"></i>
                        </div>
                        <span class="genre-name">Terror</span>
                    </div>
                    <div class="genre-option" data-genre="Filosofia">
                        <div class="genre-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <span class="genre-name">Filosofia</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelGenreSelection">Cancelar</button>
                <button type="button" class="btn-primary" id="saveGenres">Salvar Gêneros</button>
            </div>
        </div>
    </div>

    <!-- Edit Book Modal -->
    <div id="editBookModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2>Editar Livro</h2>
                <button class="modal-close" id="closeEditBookModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="editBookForm">
                    <input type="hidden" id="editBookId" name="editBookId">
                    
                    <div class="form-group">
                        <label for="editBookTitle">Título</label>
                        <input type="text" id="editBookTitle" name="editBookTitle" placeholder="Digite o título do livro" required>
                    </div>

                    <div class="form-group">
                        <label for="editBookAuthor">Autor</label>
                        <input type="text" id="editBookAuthor" name="editBookAuthor" placeholder="Digite o nome do autor" required>
                    </div>

                    <div class="form-group">
                        <label for="editBookGenre">Gênero</label>
                        <select id="editBookGenre" name="editBookGenre" required>
                            <option value="">Selecione um gênero</option>
                            <option value="Ficção">Ficção</option>
                            <option value="Romance">Romance</option>
                            <option value="Terror">Terror</option>
                            <option value="Fantasia">Fantasia</option>
                            <option value="Mistério">Mistério</option>
                            <option value="Biografia">Biografia</option>
                            <option value="História">História</option>
                            <option value="Autoajuda">Autoajuda</option>
                            <option value="Ciência">Ciência</option>
                            <option value="Tecnologia">Tecnologia</option>
                            <option value="Filosofia">Filosofia</option>
                            <option value="Poesia">Poesia</option>
                            <option value="Drama">Drama</option>
                            <option value="Aventura">Aventura</option>
                            <option value="Suspense">Suspense</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editBookStatus">Status</label>
                        <select id="editBookStatus" name="editBookStatus" required>
                            <option value="">Selecione o status</option>
                            <option value="Quero ler">Quero ler</option>
                            <option value="Lendo">Lendo</option>
                            <option value="Finalizado">Finalizado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="editBookPages">Total de páginas</label>
                        <input type="number" id="editBookPages" name="editBookPages" placeholder="0" min="1">
                    </div>

                    <div class="form-group">
                        <label for="editBookCover">URL da Capa</label>
                        <input type="url" id="editBookCover" name="editBookCover" placeholder="https://exemplo.com/capa.jpg">
                    </div>

                    <div class="form-group">
                        <label for="editBookReview">Resenha (opcional)</label>
                        <textarea id="editBookReview" name="editBookReview" placeholder="Escreva sua opinião sobre o livro..." rows="4"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="editBookFavorite" name="editBookFavorite">
                            <span class="checkmark"></span>
                            Marcar como favorito
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelEditBook">Cancelar</button>
                <button type="submit" class="btn-primary" id="updateBook">Atualizar Livro</button>
            </div>
        </div>
    </div>

    <script>
        // Tab functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Dark mode functionality
            const darkModeToggle = document.getElementById('darkModeToggle');
            const body = document.body;
            
            // Load saved theme preference
            const savedTheme = loadFromLocalStorage('theme') || 'light';
            if (savedTheme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
            }
            
            darkModeToggle.addEventListener('click', function() {
                const currentTheme = body.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                body.setAttribute('data-theme', newTheme);
                saveToLocalStorage('theme', newTheme);
                
                const icon = this.querySelector('i');
                if (newTheme === 'dark') {
                    icon.classList.replace('fa-moon', 'fa-sun');
                } else {
                    icon.classList.replace('fa-sun', 'fa-moon');
                }
            });
            
            const tabButtons = document.querySelectorAll('.tab-btn');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show/hide tab content
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                    console.log(`Switched to tab: ${tabName}`);
                });
            });
            
            // Genre tag functionality and modal
            const genreTags = document.querySelectorAll('.genre-tag');
            const genreSelectionModal = document.getElementById('genreSelectionModal');
            const closeGenreModal = document.getElementById('closeGenreModal');
            const cancelGenreSelection = document.getElementById('cancelGenreSelection');
            const saveGenres = document.getElementById('saveGenres');
            
            genreTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    // Open genre selection modal instead of toggling
                    genreSelectionModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Load current selections
                    loadCurrentGenreSelections();
                });
            });

            // Genre selection modal functionality
            const genreOptions = document.querySelectorAll('.genre-option');
            
            genreOptions.forEach(option => {
                option.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });

            // Close genre modal functionality
            function closeGenreModalFunc() {
                genreSelectionModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }

            if (closeGenreModal) {
                closeGenreModal.addEventListener('click', closeGenreModalFunc);
            }

            if (cancelGenreSelection) {
                cancelGenreSelection.addEventListener('click', closeGenreModalFunc);
            }

            // Close modal when clicking outside
            genreSelectionModal.addEventListener('click', function(e) {
                if (e.target === genreSelectionModal) {
                    closeGenreModalFunc();
                }
            });

            // Save genres functionality
            if (saveGenres) {
                saveGenres.addEventListener('click', function() {
                    const selectedGenres = [];
                    const selectedOptions = document.querySelectorAll('.genre-option.selected');
                    
                    selectedOptions.forEach(option => {
                        selectedGenres.push(option.dataset.genre);
                    });

                    // Update genre tags in profile
                    updateGenreTags(selectedGenres);
                    
                    // Save to localStorage
                    saveToLocalStorage('selectedGenres', selectedGenres);
                    
                    // Show success notification
                    showNotification(`${selectedGenres.length} gêneros selecionados!`, 'success');
                    
                    // Close modal
                    closeGenreModalFunc();
                });
            }
            
            // Favorite button functionality
            const favoriteButtons = document.querySelectorAll('.action-btn.favorite');
            
            favoriteButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Toggle favorite state
                    this.classList.toggle('active');
                    
                    const icon = this.querySelector('i');
                    if (this.classList.contains('active')) {
                        icon.classList.remove('far');
                        icon.classList.add('fas');
                    } else {
                        icon.classList.remove('fas');
                        icon.classList.add('far');
                    }
                });
            });
            
            // Edit button functionality
            const editButtons = document.querySelectorAll('.action-btn.edit');
            
            editButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    console.log('Edit book clicked');
                    // Here you would implement edit functionality
                });
            });
            
            // Delete button functionality
            const deleteButtons = document.querySelectorAll('.action-btn.delete');
            
            deleteButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    if (confirm('Tem certeza que deseja remover este livro?')) {
                        const bookCard = this.closest('.book-card');
                        bookCard.style.transform = 'scale(0)';
                        bookCard.style.opacity = '0';
                        
                        setTimeout(() => {
                            bookCard.remove();
                        }, 300);
                    }
                });
            });
            
            // Add book button functionality
            const addBookButton = document.querySelector('.btn-primary');
            const addBookModal = document.getElementById('addBookModal');
            const closeAddBookModal = document.getElementById('closeAddBookModal');
            const cancelAddBook = document.getElementById('cancelAddBook');
            const saveBook = document.getElementById('saveBook');
            const addBookForm = document.getElementById('addBookForm');
            
            if (addBookButton) {
                addBookButton.addEventListener('click', function() {
                    addBookModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            }

            // Close add book modal functionality
            function closeAddBookModalFunc() {
                addBookModal.classList.remove('active');
                document.body.style.overflow = 'auto';
                addBookForm.reset();
            }

            if (closeAddBookModal) {
                closeAddBookModal.addEventListener('click', closeAddBookModalFunc);
            }

            if (cancelAddBook) {
                cancelAddBook.addEventListener('click', closeAddBookModalFunc);
            }

            // Close modal when clicking outside
            addBookModal.addEventListener('click', function(e) {
                if (e.target === addBookModal) {
                    closeAddBookModalFunc();
                }
            });

            // Save book functionality
            if (saveBook) {
                saveBook.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Validate required fields
                    const title = document.getElementById('bookTitle').value.trim();
                    const author = document.getElementById('bookAuthor').value.trim();
                    const genre = document.getElementById('bookGenre').value;
                    const status = document.getElementById('bookStatus').value;
                    
                    if (!title || !author || !genre || !status) {
                        showNotification('Por favor, preencha todos os campos obrigatórios.', 'error');
                        return;
                    }
                    
                    // Get form data
                    const formData = new FormData(addBookForm);
                    const bookData = {
                        id: Date.now(), // Simple ID generation
                        title: formData.get('bookTitle'),
                        author: formData.get('bookAuthor'),
                        genre: formData.get('bookGenre'),
                        status: formData.get('bookStatus'),
                        pages: formData.get('bookPages') || 0,
                        cover: formData.get('bookCover') || null,
                        review: formData.get('bookReview') || '',
                        favorite: formData.get('bookFavorite') === 'on',
                        dateAdded: new Date().toISOString()
                    };

                    // Add book to the appropriate section
                    addBookToSection(bookData);
                    
                    // Save to localStorage
                    saveBookToStorage(bookData);
                    
                    // Update favorites display
                    updateFavoritesDisplay();
                    
                    // Update reading stats
                    updateReadingStats();
                    
                    // Show success notification
                    showNotification('Livro adicionado com sucesso!', 'success');
                    
                    // Close modal
                    closeAddBookModalFunc();
                });
            }

            // Edit book modal functionality
            const editBookModal = document.getElementById('editBookModal');
            const closeEditBookModal = document.getElementById('closeEditBookModal');
            const cancelEditBook = document.getElementById('cancelEditBook');
            const updateBook = document.getElementById('updateBook');
            const editBookForm = document.getElementById('editBookForm');

            // Close edit book modal functionality
            function closeEditBookModalFunc() {
                editBookModal.classList.remove('active');
                document.body.style.overflow = 'auto';
                editBookForm.reset();
            }

            if (closeEditBookModal) {
                closeEditBookModal.addEventListener('click', closeEditBookModalFunc);
            }

            if (cancelEditBook) {
                cancelEditBook.addEventListener('click', closeEditBookModalFunc);
            }

            // Close modal when clicking outside
            editBookModal.addEventListener('click', function(e) {
                if (e.target === editBookModal) {
                    closeEditBookModalFunc();
                }
            });

            // Update book functionality
            if (updateBook) {
                updateBook.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Validate required fields
                    const title = document.getElementById('editBookTitle').value.trim();
                    const author = document.getElementById('editBookAuthor').value.trim();
                    const genre = document.getElementById('editBookGenre').value;
                    const status = document.getElementById('editBookStatus').value;
                    const bookId = document.getElementById('editBookId').value;
                    
                    if (!title || !author || !genre || !status) {
                        showNotification('Por favor, preencha todos os campos obrigatórios.', 'error');
                        return;
                    }
                    
                    // Get form data
                    const formData = new FormData(editBookForm);
                    const updatedBookData = {
                        id: parseInt(bookId),
                        title: formData.get('editBookTitle'),
                        author: formData.get('editBookAuthor'),
                        genre: formData.get('editBookGenre'),
                        status: formData.get('editBookStatus'),
                        pages: formData.get('editBookPages') || 0,
                        cover: formData.get('editBookCover') || null,
                        review: formData.get('editBookReview') || '',
                        favorite: formData.get('editBookFavorite') === 'on',
                        dateAdded: new Date().toISOString() // Keep original or update
                    };

                    // Update book in storage and display
                    updateBookInStorage(updatedBookData);
                    updateBookDisplay(updatedBookData);
                    
                    // Update reading stats
                    updateReadingStats();
                    
                    // Show success notification
                    showNotification('Livro atualizado com sucesso!', 'success');
                    
                    // Close modal
                    closeEditBookModalFunc();
                });
            }
            
            // Edit profile button functionality
            const editProfileButton = document.querySelector('.btn-secondary');
            const editProfileModal = document.getElementById('editProfileModal');
            const closeEditModal = document.getElementById('closeEditModal');
            const cancelEdit = document.getElementById('cancelEdit');
            const saveProfile = document.getElementById('saveProfile');
            const editProfileForm = document.getElementById('editProfileForm');
            
            if (editProfileButton) {
                editProfileButton.addEventListener('click', function() {
                    editProfileModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            }

            // Close modal functionality
            function closeModal() {
                editProfileModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }

            if (closeEditModal) {
                closeEditModal.addEventListener('click', closeModal);
            }

            if (cancelEdit) {
                cancelEdit.addEventListener('click', closeModal);
            }

            // Close modal when clicking outside
            editProfileModal.addEventListener('click', function(e) {
                if (e.target === editProfileModal) {
                    closeModal();
                }
            });

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && editProfileModal.classList.contains('active')) {
                    closeModal();
                }
            });

            // Save profile functionality
            if (saveProfile) {
                saveProfile.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Get form data
                    const formData = new FormData(editProfileForm);
                    const profileData = {
                        fullName: formData.get('fullName'),
                        username: formData.get('username'),
                        age: formData.get('age'),
                        location: formData.get('location'),
                        profession: formData.get('profession'),
                        bio: formData.get('bio'),
                        readingGoal: formData.get('readingGoal')
                    };

                    // Update profile information on the page
                    updateProfileDisplay(profileData);
                    
                    // Save to localStorage
                    saveToLocalStorage('userProfile', profileData);
                    
                    // Show success notification
                    showNotification('Perfil atualizado com sucesso!', 'success');
                    
                    // Close modal
                    closeModal();
                });
            }
            
            // Profile avatar edit functionality
            const editAvatarButton = document.querySelector('.edit-profile-btn');
            
            if (editAvatarButton) {
                editAvatarButton.addEventListener('click', function() {
                    console.log('Edit avatar clicked');
                    
                    // Create file input for image upload
                    const fileInput = document.createElement('input');
                    fileInput.type = 'file';
                    fileInput.accept = 'image/*';
                    fileInput.style.display = 'none';
                    
                    fileInput.addEventListener('change', function(event) {
                        const file = event.target.files[0];
                        if (file) {
                            // Validate file type
                            if (!file.type.startsWith('image/')) {
                                showNotification('Por favor, selecione apenas arquivos de imagem.', 'error');
                                return;
                            }
                            
                            // Validate file size (max 5MB)
                            if (file.size > 5 * 1024 * 1024) {
                                showNotification('O arquivo deve ter no máximo 5MB.', 'error');
                                return;
                            }
                            
                            // Create FileReader to convert image to base64
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                const base64Image = e.target.result;
                                
                                // Update profile avatar
                                updateProfileAvatar(base64Image);
                                
                                // Save to localStorage
                                saveToLocalStorage('profileAvatar', base64Image);
                                
                                showNotification('Foto de perfil atualizada com sucesso!', 'success');
                            };
                            
                            reader.onerror = function() {
                                showNotification('Erro ao carregar a imagem. Tente novamente.', 'error');
                            };
                            
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    // Trigger file selection
                    document.body.appendChild(fileInput);
                    fileInput.click();
                    document.body.removeChild(fileInput);
                });
            }
            
            // Smooth scrolling for internal navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // Book card hover effects
            const bookCards = document.querySelectorAll('.book-card');
            
            bookCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.zIndex = '10';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.zIndex = '1';
                });
            });
            
            // Reading stats animation on page load
            const statNumbers = document.querySelectorAll('.stat-number');
            
            function animateNumbers() {
                statNumbers.forEach(stat => {
                    const finalNumber = parseInt(stat.textContent);
                    let currentNumber = 0;
                    const increment = finalNumber / 20;
                    
                    const timer = setInterval(() => {
                        currentNumber += increment;
                        if (currentNumber >= finalNumber) {
                            stat.textContent = finalNumber;
                            clearInterval(timer);
                        } else {
                            stat.textContent = Math.floor(currentNumber);
                        }
                    }, 50);
                });
            }
            
            // Trigger animation after a short delay
            setTimeout(animateNumbers, 500);
            
            // Load saved profile avatar
            loadProfileAvatar();
            
            // Search functionality (placeholder)
            function searchBooks(query) {
                const bookCards = document.querySelectorAll('.book-card');
                const searchTerm = query.toLowerCase();
                
                bookCards.forEach(card => {
                    const title = card.querySelector('.book-title').textContent.toLowerCase();
                    const author = card.querySelector('.book-author').textContent.toLowerCase();
                    
                    if (title.includes(searchTerm) || author.includes(searchTerm)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
            
            // Lazy loading for book covers (if needed)
            const bookCovers = document.querySelectorAll('.book-cover img');
            
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.style.opacity = '0';
                        img.style.transition = 'opacity 0.3s ease';
                        
                        setTimeout(() => {
                            img.style.opacity = '1';
                        }, 100);
                        
                        observer.unobserve(img);
                    }
                });
            });
            
            bookCovers.forEach(img => {
                imageObserver.observe(img);
            });
        });

        // Add book to section function
        function addBookToSection(bookData) {
            // Determine which section to add the book to based on status
            let targetSection;
            switch (bookData.status) {
                case 'Quero ler':
                    targetSection = document.querySelector('#want-to-read');
                    break;
                case 'Lendo':
                    targetSection = document.querySelector('#currently-reading');
                    break;
                case 'Finalizado':
                    targetSection = document.querySelector('#finished-books');
                    break;
                default:
                    targetSection = document.querySelector('#want-to-read');
            }
            
            // Remove empty state if it exists
            const emptyState = targetSection.querySelector('.empty-state');
            if (emptyState) {
                emptyState.remove();
            }
            
            // Add or create book grid
            let bookGrid = targetSection.querySelector('.book-grid');
            if (!bookGrid) {
                bookGrid = document.createElement('div');
                bookGrid.className = 'book-grid';
                targetSection.appendChild(bookGrid);
            }
            
            const bookCard = createBookCard(bookData);
            bookGrid.appendChild(bookCard);
        }

        // Create book card function
        function createBookCard(bookData) {
            const bookCard = document.createElement('div');
            bookCard.className = 'book-card';
            bookCard.dataset.bookId = bookData.id;
            
            const coverUrl = bookData.cover || createPlaceholderCover(bookData.title);
            const statusClass = bookData.status === 'Finalizado' ? 'finished' : 'reading';
            
            bookCard.innerHTML = `
                <div class="book-cover">
                    <img src="${coverUrl}" alt="${bookData.title}">
                </div>
                <div class="book-info">
                    <h4 class="book-title">${bookData.title}</h4>
                    <p class="book-author">${bookData.author}</p>
                    <span class="book-status ${statusClass}">${bookData.status}</span>
                </div>
                <div class="book-actions">
                    <button class="action-btn favorite ${bookData.favorite ? 'active' : ''}">
                        <i class="${bookData.favorite ? 'fas' : 'far'} fa-heart"></i>
                    </button>
                    <button class="action-btn edit">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            // Add event listeners to the new book card
            addBookCardEventListeners(bookCard);
            
            return bookCard;
        }

        // Create placeholder cover function
        function createPlaceholderCover(title) {
            const titleWords = title.split(' ');
            const displayTitle = titleWords.slice(0, 2).join(' ').toUpperCase();
            
            return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='180' viewBox='0 0 120 180'%3E%3Crect width='120' height='180' fill='%23212529'/%3E%3Ctext x='60' y='90' text-anchor='middle' fill='white' font-size='10' font-weight='bold'%3E${encodeURIComponent(displayTitle)}%3C/text%3E%3C/svg%3E`;
        }

        // Add event listeners to book card
        function addBookCardEventListeners(bookCard) {
            const favoriteBtn = bookCard.querySelector('.action-btn.favorite');
            const editBtn = bookCard.querySelector('.action-btn.edit');
            const deleteBtn = bookCard.querySelector('.action-btn.delete');
            
            favoriteBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                const bookId = bookCard.dataset.bookId;
                const isCurrentlyFavorite = this.classList.contains('active');
                
                // Toggle favorite status
                this.classList.toggle('active');
                const icon = this.querySelector('i');
                if (this.classList.contains('active')) {
                    icon.classList.remove('far');
                    icon.classList.add('fas');
                } else {
                    icon.classList.remove('fas');
                    icon.classList.add('far');
                }
                
                // Update book in localStorage
                let books = loadFromLocalStorage('userBooks') || [];
                const bookIndex = books.findIndex(book => book.id == bookId);
                if (bookIndex !== -1) {
                    books[bookIndex].favorite = !isCurrentlyFavorite;
                    saveToLocalStorage('userBooks', books);
                    
                    // Update favorites section
                    updateFavoritesDisplay();
                }
                
                updateReadingStats();
            });
            
            editBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                const bookId = bookCard.dataset.bookId;
                openEditBookModal(bookId);
            });
            
            deleteBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                if (confirm('Tem certeza que deseja remover este livro?')) {
                    const bookId = bookCard.dataset.bookId;
                    removeBookFromStorage(bookId);
                    bookCard.style.transform = 'scale(0)';
                    bookCard.style.opacity = '0';
                    setTimeout(() => {
                        bookCard.remove();
                        updateReadingStats();
                    }, 300);
                }
            });
            
            // Add hover effects
            bookCard.addEventListener('mouseenter', function() {
                this.style.zIndex = '10';
            });
            
            bookCard.addEventListener('mouseleave', function() {
                this.style.zIndex = '1';
            });
        }

        // Save book to localStorage
        function saveBookToStorage(bookData) {
            let books = loadFromLocalStorage('userBooks') || [];
            books.push(bookData);
            saveToLocalStorage('userBooks', books);
        }

        // Remove book from localStorage
        function removeBookFromStorage(bookId) {
            let books = loadFromLocalStorage('userBooks') || [];
            books = books.filter(book => book.id != bookId);
            saveToLocalStorage('userBooks', books);
        }

        // Open edit book modal
        function openEditBookModal(bookId) {
            const books = loadFromLocalStorage('userBooks') || [];
            const book = books.find(b => b.id == bookId);
            
            if (!book) {
                showNotification('Livro não encontrado.', 'error');
                return;
            }

            // Populate form with book data
            document.getElementById('editBookId').value = book.id;
            document.getElementById('editBookTitle').value = book.title;
            document.getElementById('editBookAuthor').value = book.author;
            document.getElementById('editBookGenre').value = book.genre;
            document.getElementById('editBookStatus').value = book.status;
            document.getElementById('editBookPages').value = book.pages || '';
            document.getElementById('editBookCover').value = book.cover || '';
            document.getElementById('editBookReview').value = book.review || '';
            document.getElementById('editBookFavorite').checked = book.favorite || false;

            // Open modal
            document.getElementById('editBookModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Update book in localStorage
        function updateBookInStorage(updatedBookData) {
            let books = loadFromLocalStorage('userBooks') || [];
            const bookIndex = books.findIndex(book => book.id == updatedBookData.id);
            
            if (bookIndex !== -1) {
                // Preserve original date if it exists
                updatedBookData.dateAdded = books[bookIndex].dateAdded || updatedBookData.dateAdded;
                books[bookIndex] = updatedBookData;
                saveToLocalStorage('userBooks', books);
            }
        }

        // Update favorites display
        function updateFavoritesDisplay() {
            const favoritesSection = document.querySelector('#favorites');
            if (!favoritesSection) return;

            // Clear current favorites display completely
            const existingContent = favoritesSection.querySelectorAll('.book-grid, .empty-state');
            existingContent.forEach(element => element.remove());

            // Get all favorite books
            const books = loadFromLocalStorage('userBooks') || [];
            const favoriteBooks = books.filter(book => book.favorite);

            if (favoriteBooks.length === 0) {
                // Show empty state only if none exists
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = '<i class="fas fa-heart"></i><p>Nenhum livro favorito ainda.</p>';
                favoritesSection.appendChild(emptyState);
            } else {
                // Create new grid with favorite books
                const newGrid = document.createElement('div');
                newGrid.className = 'book-grid';
                
                favoriteBooks.forEach(book => {
                    const bookCard = createBookCard(book);
                    newGrid.appendChild(bookCard);
                });
                
                favoritesSection.appendChild(newGrid);
            }
        }

        // Update book display
        function updateBookDisplay(updatedBookData) {
            // Remove all instances of this book from display
            const allBookCards = document.querySelectorAll(`[data-book-id="${updatedBookData.id}"]`);
            allBookCards.forEach(card => card.remove());
            
            // Add book back to appropriate sections
            addBookToSection(updatedBookData);
            
            // Update favorites display
            updateFavoritesDisplay();
        }

        // Load current genre selections
        function loadCurrentGenreSelections() {
            const savedGenres = loadFromLocalStorage('selectedGenres') || [];
            const genreOptions = document.querySelectorAll('.genre-option');
            
            // Clear all selections first
            genreOptions.forEach(option => {
                option.classList.remove('selected');
            });
            
            // Apply saved selections
            savedGenres.forEach(genre => {
                const option = document.querySelector(`[data-genre="${genre}"]`);
                if (option) {
                    option.classList.add('selected');
                }
            });
        }

        // Update genre tags in profile
        function updateGenreTags(selectedGenres) {
            const genreTagsContainer = document.querySelector('.genre-tags');
            if (!genreTagsContainer) return;
            
            // Clear existing tags
            genreTagsContainer.innerHTML = '';
            
            // Add selected genres as tags
            selectedGenres.forEach((genre, index) => {
                const tag = document.createElement('span');
                tag.className = 'genre-tag active';
                tag.textContent = genre;
                
                // Add click listener to open modal
                tag.addEventListener('click', function() {
                    document.getElementById('genreSelectionModal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                    loadCurrentGenreSelections();
                });
                
                genreTagsContainer.appendChild(tag);
            });
            
            // If no genres selected, show default message
            if (selectedGenres.length === 0) {
                const defaultTag = document.createElement('span');
                defaultTag.className = 'genre-tag';
                defaultTag.textContent = 'Clique para selecionar gêneros';
                defaultTag.style.cursor = 'pointer';
                
                defaultTag.addEventListener('click', function() {
                    document.getElementById('genreSelectionModal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                    loadCurrentGenreSelections();
                });
                
                genreTagsContainer.appendChild(defaultTag);
            }
        }

        // Update profile avatar function
        function updateProfileAvatar(imageSrc) {
            const profileAvatar = document.querySelector('.profile-avatar img');
            if (profileAvatar) {
                profileAvatar.src = imageSrc;
                profileAvatar.style.objectFit = 'cover';
            }
        }

        // Load saved profile avatar
        function loadProfileAvatar() {
            const savedAvatar = loadFromLocalStorage('profileAvatar');
            if (savedAvatar) {
                updateProfileAvatar(savedAvatar);
            }
        }

        // Update profile display function
        function updateProfileDisplay(profileData) {
            // Update profile name
            const profileName = document.querySelector('.profile-name');
            if (profileName && profileData.fullName) {
                profileName.textContent = profileData.fullName.toUpperCase();
            }

            // Update username
            const profileUsername = document.querySelector('.profile-username');
            if (profileUsername && profileData.username) {
                profileUsername.textContent = profileData.username;
            }

            // Update about section info
            const infoItems = document.querySelectorAll('.info-item span');
            infoItems.forEach(item => {
                const text = item.innerHTML;
                if (text.includes('Localização:') && profileData.location) {
                    item.innerHTML = `<strong>Localização:</strong> ${profileData.location}`;
                }
                if (text.includes('Idade:') && profileData.age) {
                    item.innerHTML = `<strong>Idade:</strong> ${profileData.age} anos`;
                }
                if (text.includes('Profissão:') && profileData.profession) {
                    item.innerHTML = `<strong>Profissão:</strong> ${profileData.profession}`;
                }
                if (text.includes('Meta de Leitura:') && profileData.readingGoal) {
                    item.innerHTML = `<strong>Meta de Leitura:</strong> ${profileData.readingGoal} livros por ano`;
                }
            });

            // Update bio
            const bioElement = document.querySelector('.bio p');
            if (bioElement && profileData.bio) {
                bioElement.innerHTML = `<em>${profileData.bio}</em>`;
            }
        }

        // Utility functions
        function updateReadingStats() {
            // Get books from localStorage instead of counting DOM elements
            const books = loadFromLocalStorage('userBooks') || [];
            
            // Count books by status from stored data
            const finishedBooks = books.filter(book => book.status === 'Finalizado').length;
            const favoriteBooks = books.filter(book => book.favorite === true).length;
            const currentlyReading = books.filter(book => book.status === 'Lendo').length;
            
            // Update the stats display
            const statItems = document.querySelectorAll('.stat-item .stat-number');
            if (statItems.length >= 3) {
                statItems[0].textContent = finishedBooks; // Lidos
                statItems[1].textContent = favoriteBooks; // Favoritos
                statItems[2].textContent = currentlyReading; // Lendo
            }
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            
            // Style the notification
            const bgColor = type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--error)' : 'var(--primary)';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 12px var(--shadow);
                z-index: 1000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Local storage functions for persisting data
        function saveToLocalStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (error) {
                console.warn('Could not save to localStorage:', error);
            }
        }

        function loadFromLocalStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (error) {
                console.warn('Could not load from localStorage:', error);
                return null;
            }
        }

        // Tab switching function
        function switchTab(tabName) {
            // Hide all tab panels
            const tabPanels = document.querySelectorAll('.tab-panel');
            tabPanels.forEach(panel => {
                panel.classList.remove('active');
                panel.style.display = 'none';
            });

            // Show selected tab panel
            const targetPanel = document.getElementById(`tab-${tabName}`);
            if (targetPanel) {
                targetPanel.classList.add('active');
                targetPanel.style.display = 'block';
            }

            // Load specific tab content
            if (tabName === 'resenhas') {
                loadReviews();
            }
        }

        // Load and display reviews
        function loadReviews() {
            const books = loadFromLocalStorage('userBooks') || [];
            const booksWithReviews = books.filter(book => book.review && book.review.trim() !== '');
            
            const reviewsContainer = document.getElementById('reviewsContainer');
            const totalReviewsSpan = document.getElementById('totalReviews');
            
            if (!reviewsContainer || !totalReviewsSpan) return;

            // Update reviews count
            totalReviewsSpan.textContent = booksWithReviews.length;

            // Clear container
            reviewsContainer.innerHTML = '';

            if (booksWithReviews.length === 0) {
                // Show empty state
                reviewsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-pen-fancy"></i>
                        <p>Nenhuma resenha escrita ainda.</p>
                        <p class="empty-subtitle">Adicione livros com resenhas para vê-las aqui!</p>
                    </div>
                `;
                return;
            }

            // Display reviews
            booksWithReviews.forEach(book => {
                const reviewCard = createReviewCard(book);
                reviewsContainer.appendChild(reviewCard);
            });
        }

        // Create review card
        function createReviewCard(book) {
            const reviewCard = document.createElement('div');
            reviewCard.className = 'review-card';
            reviewCard.dataset.bookId = book.id;

            const coverUrl = book.cover || createPlaceholderCover(book.title);
            const reviewDate = new Date(book.dateAdded).toLocaleDateString('pt-BR');

            reviewCard.innerHTML = `
                <div class="review-header">
                    <div class="review-book-cover">
                        <img src="${coverUrl}" alt="${book.title}">
                    </div>
                    <div class="review-book-info">
                        <h4 class="review-book-title">${book.title}</h4>
                        <p class="review-book-author">por ${book.author}</p>
                        <span class="review-book-genre">${book.genre}</span>
                    </div>
                </div>
                <div class="review-content">
                    <div class="review-text">${book.review}</div>
                </div>
                <div class="review-footer">
                    <span class="review-date">Escrita em ${reviewDate}</span>
                    <div class="review-actions">
                        <button class="action-btn edit-review" data-book-id="${book.id}" title="Editar resenha">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-review" data-book-id="${book.id}" title="Remover resenha">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;

            // Add event listeners for review actions
            const editBtn = reviewCard.querySelector('.edit-review');
            const deleteBtn = reviewCard.querySelector('.delete-review');

            editBtn.addEventListener('click', function() {
                openEditBookModal(book.id);
            });

            deleteBtn.addEventListener('click', function() {
                if (confirm('Tem certeza que deseja remover esta resenha?')) {
                    removeReviewFromBook(book.id);
                }
            });

            return reviewCard;
        }

        // Remove review from book
        function removeReviewFromBook(bookId) {
            const books = loadFromLocalStorage('userBooks') || [];
            const bookIndex = books.findIndex(book => book.id == bookId);
            
            if (bookIndex !== -1) {
                books[bookIndex].review = '';
                saveToLocalStorage('userBooks', books);
                loadReviews(); // Refresh reviews display
                showNotification('Resenha removida com sucesso!', 'success');
            }
        }

        // Load saved books function
        function loadSavedBooks() {
            const savedBooks = loadFromLocalStorage('userBooks');
            if (savedBooks && savedBooks.length > 0) {
                savedBooks.forEach(bookData => {
                    addBookToSection(bookData);
                });
                updateReadingStats();
            }
        }

        // Initialize app
        function initializeApp() {
            // Load user preferences and update genre tags
            const savedGenres = loadFromLocalStorage('selectedGenres') || [];
            updateGenreTags(savedGenres);
            
            // Load saved profile data
            const savedProfile = loadFromLocalStorage('userProfile');
            if (savedProfile) {
                updateProfileDisplay(savedProfile);
                
                // Update form fields with saved data
                const editForm = document.getElementById('editProfileForm');
                if (editForm) {
                    editForm.fullName.value = savedProfile.fullName || '';
                    editForm.username.value = savedProfile.username || '';
                    editForm.age.value = savedProfile.age || '';
                    editForm.location.value = savedProfile.location || '';
                    editForm.profession.value = savedProfile.profession || '';
                    editForm.bio.value = savedProfile.bio || '';
                    editForm.readingGoal.value = savedProfile.readingGoal || '';
                }
            }
            
            // Initialize default tab (biblioteca)
            switchTab('biblioteca');
            
            // Load saved books
            loadSavedBooks();
            
            // Load favorite books
            const favoriteBooks = loadFromLocalStorage('favoriteBooks');
            if (favoriteBooks) {
                const favoriteButtons = document.querySelectorAll('.action-btn.favorite');
                favoriteButtons.forEach((button, index) => {
                    if (favoriteBooks.includes(index)) {
                        button.classList.add('active');
                        const icon = button.querySelector('i');
                        icon.classList.remove('far');
                        icon.classList.add('fas');
                    }
                });
            }
        }

        // Call initialize function when DOM is loaded
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
